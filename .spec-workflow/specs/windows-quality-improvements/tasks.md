# Tasks Document

## Phase 1: Investigation & Bug Discovery

- [x] 1. Audit memory safety in RawInputManager
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - Analyze Box::into_raw() usage at lines 52-60
  - Verify pointer reconstruction in Drop implementation (lines 177-187)
  - Check for use-after-free scenarios during wnd_proc execution
  - Check for double-free scenarios with external window destruction
  - Document thread safety assumptions for raw pointer access
  - Identify lifetime mismatches between HWND and Rust ownership
  - Purpose: Find CRITICAL memory safety bugs in raw pointer management
  - _Leverage: Existing Drop implementation pattern_
  - _Requirements: 1.1 (Memory Safety), Success Criteria (Find 5+ bugs)_
  - _Prompt: Role: Rust unsafe code auditor specializing in memory safety | Task: Audit RawInputManager raw pointer usage following requirement 1.1, analyzing Box::into_raw at lines 52-60 and Drop at 177-187 for use-after-free and double-free scenarios | Restrictions: Focus on memory safety only, document but don't fix bugs yet, classify severity as CRITICAL/HIGH/MEDIUM/LOW | Success: Complete list of memory safety issues with severity ratings, documented scenarios for each bug, clear reproduction conditions_

- [x] 2. Audit RwLock poisoning risks
  - File: keyrx_daemon/src/platform/windows/device_map.rs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - Find all .write().unwrap() calls (device_map.rs:94, rawinput.rs:74)
  - Find all .read().unwrap() calls (rawinput.rs:298)
  - Identify panic paths while holding locks
  - Check for lock acquisition in wnd_proc callback
  - Document cascade failure scenarios
  - Verify no recovery mechanisms exist
  - Purpose: Find HIGH priority bugs in synchronization primitives
  - _Leverage: Linux bug hunt methodology for unwrap auditing_
  - _Requirements: 1.2 (RwLock Poisoning), Success Criteria (Categorize by severity)_
  - _Prompt: Role: Concurrency expert specializing in Rust synchronization primitives | Task: Audit all RwLock usage following requirement 1.2, finding .unwrap() calls and panic scenarios that cause lock poisoning | Restrictions: Document panic cascades, verify no fallback error handling exists, check wnd_proc callback safety | Success: List of all RwLock unwrap locations, documented cascade scenarios, severity classification for each issue_

- [x] 3. Audit message queue and event processing
  - File: keyrx_daemon/src/main.rs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - Analyze GetRawInputData memory allocation at rawinput.rs:214-230
  - Check for buffer size limits in message pump (main.rs:185-220)
  - Verify rate limiting on keyboard events
  - Check for message queue timeout or watchdog
  - Identify lost event scenarios under high load
  - Document unbounded memory allocation risks
  - Purpose: Find HIGH priority bugs in message queue handling
  - _Leverage: Linux poll error backoff pattern for comparison_
  - _Requirements: 1.3 (Message Queue), Success Criteria (Find 8+ bugs)_
  - _Prompt: Role: Windows systems programmer with expertise in message pumps and Raw Input API | Task: Audit message queue and GetRawInputData following requirement 1.3, checking for unbounded allocations and overflow scenarios | Restrictions: Focus on memory exhaustion and lost events, document performance under high event rates, verify no rate limiting exists | Success: List of message queue bugs with memory limits, overflow scenarios documented, performance risks identified_

- [x] 4. Audit error recovery and crash resilience
  - File: keyrx_daemon/src/main.rs
  - File: keyrx_daemon/src/platform/windows/mod.rs
  - Check for panic handlers in DispatchMessageW (main.rs:185-220)
  - Verify restart mechanism exists
  - Analyze init() error path cleanup (mod.rs:43-52)
  - Check Windows API error recovery mechanisms
  - Document unhandled panic scenarios
  - Verify partial cleanup on initialization failure
  - Purpose: Find HIGH priority bugs in error handling
  - _Leverage: Linux signal handler recovery patterns_
  - _Requirements: 1.4 (Error Recovery), Success Criteria (Document root causes)_
  - _Prompt: Role: Reliability engineer specializing in fault tolerance and error recovery | Task: Audit error recovery mechanisms following requirement 1.4, checking panic handling in message loop and init cleanup | Restrictions: Document crash scenarios without restart, verify no recovery from Windows API failures, identify partial cleanup issues | Success: List of error recovery gaps, crash scenarios documented, missing recovery mechanisms identified_

- [x] 5. Audit device hotplug handling
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - File: keyrx_daemon/src/platform/windows/device_map.rs
  - Check WM_INPUT_DEVICE_CHANGE handler at rawinput.rs:243-260
  - Find silent failures with `let _ = add_device()`
  - Verify config reload on device addition
  - Identify race conditions during device removal
  - Check for stale device references after removal
  - Document device lifecycle management
  - Purpose: Find MEDIUM priority bugs in hotplug support
  - _Leverage: BUG #37 fix from Linux (device hot-unplug handling)_
  - _Requirements: 1.5 (Device Management), Success Criteria (Tests for all bugs)_
  - _Prompt: Role: Device driver developer with expertise in Windows PnP and hotplug | Task: Audit device hotplug handling following requirement 1.5, analyzing WM_INPUT_DEVICE_CHANGE and device lifecycle | Restrictions: Focus on silent failures and race conditions, verify no config reload on device add, document stale references | Success: List of hotplug bugs, race condition scenarios, silent failure patterns identified_

- [x] 6. Audit Windows API error handling
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - File: keyrx_daemon/src/platform/windows/inject.rs
  - Check RegisterClassExW error handling (rawinput.rs:109-131)
  - Check CreateWindowExW error handling (rawinput.rs:142-153)
  - Verify SendInput return value validation (inject.rs)
  - Find missing GetLastError() calls
  - Document swallowed errors in window creation
  - Verify silent failures in event injection
  - Purpose: Find MEDIUM priority bugs in Windows API usage
  - _Leverage: Linux evdev error handling patterns for comparison_
  - _Requirements: 1.6 (Windows API Errors), Success Criteria (All bugs categorized)_
  - _Prompt: Role: Win32 API expert with expertise in error handling and GetLastError patterns | Task: Audit Windows API error handling following requirement 1.6, checking RegisterClassExW, CreateWindowExW, and SendInput | Restrictions: Verify GetLastError called after each API, document missing validation, identify silent failures | Success: List of missing error checks, swallowed error locations, GetLastError gaps documented_

- [x] 7. Audit scancode and keycode mapping
  - File: keyrx_daemon/src/platform/windows/keycode.rs
  - File: keyrx_daemon/src/platform/windows/inject.rs
  - Verify MapVirtualKeyW layout dependency (keycode.rs:161-176)
  - Check for information loss in scancode → VK → KeyCode conversion
  - Verify extended key list completeness (inject.rs:49-65)
  - Check IME and special key handling
  - Document placeholder implementation notes
  - Identify hardcoded limitations
  - Purpose: Find LOW priority bugs in key mapping
  - _Leverage: Existing keycode.rs lookup table_
  - _Requirements: 1.7 (Scancode Mapping), Success Criteria (Document user impact)_
  - _Prompt: Role: Input systems developer with expertise in keyboard layouts and scancodes | Task: Audit scancode mapping following requirement 1.7, checking MapVirtualKeyW usage and extended key handling | Restrictions: Focus on layout dependency and information loss, verify IME support, document incomplete extended key list | Success: List of mapping bugs, layout dependency documented, missing keys identified_

- [x] 8. Audit resource cleanup and leaks
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - File: keyrx_daemon/src/platform/windows/mod.rs
  - Check window handle cleanup in Drop (rawinput.rs:177-187)
  - Verify Raw Input unregistration on shutdown
  - Check for channel leaks if receiver dropped
  - Verify GetRawInputData buffer cleanup
  - Identify resource leaks on error paths
  - Document lifecycle management gaps
  - Purpose: Find LOW priority bugs in resource management
  - _Leverage: Rust Drop trait patterns, Linux resource cleanup_
  - _Requirements: 1.8 (Resource Cleanup), Success Criteria (Fix all CRITICAL/HIGH bugs)_
  - _Prompt: Role: Systems programmer specializing in resource lifecycle and RAII patterns | Task: Audit resource cleanup following requirement 1.8, checking Drop implementation and error path cleanup | Restrictions: Focus on leaks and missing cleanup, verify Raw Input unregistration, check channel lifecycle | Success: List of resource leaks, missing cleanup documented, error path gaps identified_

- [x] 9. Consolidate bug findings into report
  - File: /tmp/windows-bug-hunt-findings.md (create)
  - Compile all bugs found from tasks 1-8
  - Assign severity: CRITICAL/HIGH/MEDIUM/LOW to each bug
  - Assign unique bug IDs: WIN-BUG #1, WIN-BUG #2, etc.
  - Document user impact for each bug
  - Prioritize bugs for fixing (CRITICAL → HIGH → MEDIUM → LOW)
  - Compare findings with Linux bug hunt results
  - Create summary statistics (count by severity)
  - Purpose: Create comprehensive bug report for fixing phase
  - _Leverage: Linux bug report format from /tmp/bug-fixes-complete.md_
  - _Requirements: Success Criteria (5+ bugs found, all categorized)_
  - _Prompt: Role: QA engineer specializing in bug triage and documentation | Task: Consolidate all audit findings into comprehensive report, assigning severity and unique IDs to each bug | Restrictions: Must include user impact, root cause analysis, reproduction steps, follow Linux bug report format | Success: Complete bug report with 5-14 bugs, all categorized by severity, unique IDs assigned, prioritized list created_

## Phase 2: Test Writing

- [x] 10. Create Windows test infrastructure
  - File: keyrx_daemon/tests/windows/mod.rs (create)
  - File: keyrx_daemon/tests/windows/utils.rs (create)
  - Implement VirtualWindowsKeyboard helper using SendInput
  - Implement create_test_config_windows() helper
  - Implement inject_keyboard_event() helper function
  - Document Windows testing limitations vs Linux
  - Add Windows-specific test utilities module
  - Set up test configuration for admin privileges
  - Purpose: Provide reusable test infrastructure for Windows
  - _Leverage: Linux VirtualKeyboard pattern from bug regression tests_
  - _Requirements: Testing Constraints (Windows PC required, admin privileges)_
  - _Prompt: Role: Test infrastructure developer with expertise in Windows SendInput and test harnesses | Task: Create Windows test infrastructure with VirtualWindowsKeyboard and helpers, following Linux VirtualKeyboard pattern | Restrictions: Must use SendInput for event injection, handle admin privilege requirements, document limitations vs evdev, provide clear error messages | Success: Test utilities compile, VirtualWindowsKeyboard creates events, inject helpers work, admin privilege handling documented_

- [x] 11. Write memory safety regression tests
  - File: keyrx_daemon/tests/windows/memory_safety_tests.rs (create)
  - Write test_rawinput_manager_drop_safety (use-after-free test)
  - Write test_window_external_destruction (double-free test)
  - Write test_raw_pointer_thread_safety (concurrent access test)
  - Verify tests fail before fixes (demonstrate bugs exist)
  - Document expected behavior vs actual behavior
  - Add test comments explaining what each test verifies
  - Purpose: Regression tests for CRITICAL memory safety bugs
  - _Leverage: Windows test infrastructure from task 10_
  - _Requirements: Success Criteria (Tests for all bugs), Phase 2 Testing Strategy_
  - _Prompt: Role: Rust unsafe code tester specializing in memory safety validation | Task: Write memory safety tests for bugs found in task 1, verifying use-after-free and double-free scenarios | Restrictions: Tests must fail before fixes, use Windows test infrastructure, include clear failure messages, test concurrent access | Success: 3 tests written, all demonstrate memory safety issues, clear documentation of expected vs actual behavior_

- [x] 12. Write RwLock poisoning regression tests
  - File: keyrx_daemon/tests/windows/rwlock_tests.rs (create)
  - Write test_rwlock_poison_recovery (cascade failure test)
  - Write test_wndproc_panic_handling (panic in callback test)
  - Write test_concurrent_lock_access (stress test)
  - Verify tests fail before fixes
  - Document expected recovery behavior
  - Add comments explaining poisoning scenarios
  - Purpose: Regression tests for HIGH priority RwLock bugs
  - _Leverage: Rust panic testing patterns, Windows test infrastructure_
  - _Requirements: Success Criteria (Tests written before fixes)_
  - _Prompt: Role: Concurrency testing expert specializing in lock poisoning scenarios | Task: Write RwLock poisoning tests for bugs found in task 2, testing cascade failures and panic handling | Restrictions: Must deliberately panic threads, verify cascade behavior, test wnd_proc callback safety, use Windows infrastructure | Success: 3 tests written, demonstrate poisoning cascades, document recovery expectations, all fail before fixes_

- [x] 13. Write message queue regression tests
  - File: keyrx_daemon/tests/windows/message_queue_tests.rs (create)
  - Write test_message_queue_flood (high event rate test)
  - Write test_rawinput_buffer_allocation (buffer bounds test)
  - Write test_message_queue_timeout (watchdog test)
  - Verify tests fail before fixes
  - Document memory limits and overflow behavior
  - Add performance measurements
  - Purpose: Regression tests for HIGH priority message queue bugs
  - _Leverage: Windows SendInput for event flooding, test infrastructure_
  - _Requirements: Success Criteria (Comprehensive testing)_
  - _Prompt: Role: Performance tester with expertise in Windows message pumps and stress testing | Task: Write message queue tests for bugs found in task 3, testing high event rates and buffer limits | Restrictions: Use SendInput for flooding, measure memory usage, verify overflow handling, document limits | Success: 3 tests written, demonstrate queue issues, memory limits tested, performance measured_

- [x] 14. Write error recovery regression tests
  - File: keyrx_daemon/tests/windows/error_recovery_tests.rs (create)
  - Write test_api_error_recovery (Windows API failure test)
  - Write test_init_partial_cleanup (initialization failure test)
  - Write test_daemon_restart_on_crash (recovery test)
  - Verify error logging works correctly
  - Document expected recovery behavior
  - Add cleanup verification
  - Purpose: Regression tests for HIGH priority error recovery bugs
  - _Leverage: Linux error recovery patterns, Windows test infrastructure_
  - _Requirements: Success Criteria (Fix all CRITICAL/HIGH bugs)_
  - _Prompt: Role: Reliability tester specializing in fault injection and error recovery | Task: Write error recovery tests for bugs found in task 4, testing API failures and init cleanup | Restrictions: Mock Windows API failures if possible, verify cleanup on errors, test restart mechanisms, check logging | Success: 3 tests written, demonstrate recovery gaps, cleanup verified, logging tested_

- [x] 15. Write device hotplug regression tests
  - File: keyrx_daemon/tests/windows/device_hotplug_tests.rs (create)
  - Write test_device_hotplug_handling (WM_INPUT_DEVICE_CHANGE test)
  - Write test_device_add_error_logging (code inspection test)
  - Write test_device_removal_during_events (race condition test)
  - Verify no panics on device removal
  - Document race condition scenarios
  - Add timing-sensitive test cases
  - Purpose: Regression tests for MEDIUM priority hotplug bugs
  - _Leverage: BUG #37 test patterns from Linux, Windows infrastructure_
  - _Requirements: Success Criteria (Windows-specific E2E tests)_
  - _Prompt: Role: Device hotplug tester with expertise in PnP and race conditions | Task: Write hotplug tests for bugs found in task 5, testing WM_INPUT_DEVICE_CHANGE and race conditions | Restrictions: Simulate device removal, test race conditions with timing, verify no panics, check error logging | Success: 3 tests written, hotplug scenarios tested, race conditions demonstrated, no panic on removal_

- [x] 16. Write Windows API error handling tests
  - File: keyrx_daemon/tests/windows/code_inspection_tests.rs (create)
  - Write code inspection tests for Windows API error handling
  - Verify GetLastError() calls exist after API calls
  - Verify logging in error paths
  - Verify no silent failures with `let _ =` pattern
  - Check RegisterClassExW/CreateWindowExW error handling
  - Verify SendInput validation
  - Purpose: Regression tests for MEDIUM priority API handling bugs
  - _Leverage: Linux code inspection test patterns (BUG #34, #35, #38)_
  - _Requirements: Success Criteria (Tests for all bugs)_
  - _Prompt: Role: Code quality tester specializing in static analysis and error handling patterns | Task: Write code inspection tests for bugs found in task 6, verifying Windows API error handling | Restrictions: Use source code reading, verify GetLastError patterns, check for silent failures, follow Linux inspection test format | Success: Tests verify error handling exists, GetLastError calls found, no silent failures, logging verified_

- [x] 17. Document test results and create baseline
  - File: /tmp/windows-test-results.md (create)
  - Run all Windows tests: cargo test --test windows
  - Document test results (passing/failing counts)
  - Verify tests demonstrate bugs exist (should fail)
  - Create baseline for bug fixing phase
  - Calculate test coverage statistics
  - Compare with Linux test results
  - Purpose: Establish pre-fix test baseline
  - _Leverage: Linux test results format from /tmp/bug-test-results.md_
  - _Requirements: Success Criteria (Tests written before fixes)_
  - _Prompt: Role: QA analyst specializing in test reporting and metrics | Task: Run all Windows tests and document results, creating baseline before bug fixes | Restrictions: Document all test outputs, verify expected failures, calculate coverage, compare with Linux baseline | Success: Complete test report created, all tests run, failure counts documented, baseline established_

## Phase 3: Bug Fixing

- [x] 18. Fix CRITICAL memory safety bugs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - Fix use-after-free in RawInputManager (if found)
  - Fix double-free in window destruction (if found)
  - Replace raw pointers with Arc-based design (if needed)
  - Add thread safety documentation to unsafe blocks
  - Verify tests pass after fix
  - Code review all changes
  - Purpose: Eliminate CRITICAL memory safety vulnerabilities
  - _Leverage: Rust Arc and Mutex patterns for safer pointer management_
  - _Requirements: Success Criteria (Fix all CRITICAL bugs)_
  - _Prompt: Role: Rust unsafe code expert specializing in safe pointer abstractions | Task: Fix all CRITICAL memory safety bugs found in task 1, replacing unsafe patterns with safe alternatives | Restrictions: Maintain existing API, preserve performance, document remaining unsafe blocks, ensure thread safety | Success: All memory safety tests pass, no use-after-free or double-free, Arc-based design if needed, documented safety invariants_

- [x] 19. Fix HIGH priority RwLock and hotplug bugs
  - File: keyrx_daemon/src/platform/windows/device_map.rs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - Replace .write().unwrap() with proper error handling
  - Replace .read().unwrap() with proper error handling
  - Add panic recovery in wnd_proc (if feasible)
  - Fix device hot-unplug race conditions
  - Add warning logging for lock poisoning
  - Verify tests pass after fix
  - Purpose: Eliminate HIGH priority synchronization and hotplug bugs
  - _Leverage: BUG #37 fix pattern (device hot-unplug), Arc<Mutex> if needed_
  - _Requirements: Success Criteria (Fix all HIGH bugs)_
  - _Prompt: Role: Concurrency expert and device management specialist | Task: Fix all HIGH priority RwLock and hotplug bugs found in tasks 2 and 5, replacing unwrap with error handling | Restrictions: Handle lock poisoning gracefully, fix race conditions, add logging, preserve existing behavior when no errors | Success: All RwLock and hotplug tests pass, no unwrap panics, proper error handling, race conditions eliminated_

- [x] 20. Fix MEDIUM priority message queue and error recovery bugs
  - File: keyrx_daemon/src/main.rs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - File: keyrx_daemon/src/platform/windows/mod.rs
  - Add buffer size limits to GetRawInputData (e.g., 4096 bytes max)
  - Add rate limiting or event batching (if needed)
  - Add message queue timeout or watchdog
  - Add error recovery for Windows API failures
  - Add restart mechanism or graceful degradation
  - Verify tests pass after fix
  - Purpose: Improve message queue reliability and error recovery
  - _Leverage: Linux poll error backoff pattern (BUG #34)_
  - _Requirements: Success Criteria (Achieve same quality as Linux)_
  - _Prompt: Role: System reliability engineer with Windows message pump expertise | Task: Fix all MEDIUM priority message queue and error recovery bugs found in tasks 3 and 4 | Restrictions: Bound memory allocations, add timeouts, implement error recovery, maintain performance (<1ms latency) | Success: All message queue and recovery tests pass, bounded memory, timeouts working, error recovery functional_

- [x] 21. Fix LOW priority logging and resource cleanup bugs
  - File: keyrx_daemon/src/platform/windows/rawinput.rs
  - File: keyrx_daemon/src/platform/windows/inject.rs
  - File: keyrx_daemon/src/platform/windows/keycode.rs
  - Add Windows API error logging (GetLastError)
  - Fix silent failures (replace `let _ =` with error logging)
  - Improve scancode mapping (if feasible)
  - Document known limitations (IME, special keys)
  - Fix resource leaks on error paths
  - Verify tests pass after fix
  - Purpose: Improve observability and cleanup completeness
  - _Leverage: BUG #38 fix pattern (config reload logging)_
  - _Requirements: Success Criteria (Fix all bugs)_
  - _Prompt: Role: Code quality engineer specializing in error logging and resource management | Task: Fix all LOW priority logging and cleanup bugs found in tasks 6, 7, and 8 | Restrictions: Add GetLastError calls, replace silent failures with warnings, fix leaks, document limitations | Success: All logging tests pass, no silent failures, resource leaks fixed, limitations documented_

- [x] 22. Run full test suite and verify no regressions
  - Run all Windows tests: cargo test --test windows
  - Run all cross-platform tests: cargo test --workspace
  - Run clippy: cargo clippy --workspace -- -D warnings
  - Run fmt: cargo fmt --check
  - Verify no test regressions in Linux code
  - Check code coverage with tarpaulin (if available)
  - Purpose: Ensure all bugs fixed without breaking existing code
  - _Leverage: Linux verification workflow (make verify)_
  - _Requirements: Success Criteria (All tests pass)_
  - _Prompt: Role: CI/CD engineer specializing in test automation and quality gates | Task: Run complete test suite and verify all tests pass after bug fixes | Restrictions: Must run all platforms, verify no regressions, check formatting and linting, measure coverage | Success: All tests pass (Windows + Linux + cross-platform), no clippy warnings, code formatted, no regressions_

- [x] 23. Create bug fixes summary document
  - File: /tmp/windows-bug-fixes-complete.md (create)
  - Document all bugs fixed with before/after code
  - Show test results before and after fixes
  - Count lines changed per file
  - Create statistics (bugs by severity, files modified)
  - Compare with Linux bug hunt results
  - Document any remaining known issues
  - Purpose: Comprehensive record of Windows quality improvements
  - _Leverage: Linux bug fixes summary format (/tmp/bug-fixes-complete.md)_
  - _Requirements: Success Criteria (Document all fixes)_
  - _Prompt: Role: Technical writer specializing in software change documentation | Task: Create comprehensive bug fix summary following Linux format, documenting all Windows fixes | Restrictions: Include before/after code, test results, statistics, known issues, follow /tmp/bug-fixes-complete.md format | Success: Complete summary document, all fixes documented, statistics calculated, comparison with Linux included_

## Phase 4: Documentation (Optional)

- [x] 24. Create Windows architecture documentation
  - File: keyrx_daemon/docs/windows_architecture.md (create)
  - Document Raw Input API architecture and design decisions
  - Explain message pump vs poll() design trade-offs
  - Document memory management strategy (Arc vs raw pointers)
  - Document thread safety guarantees and synchronization
  - Document testing limitations on Windows
  - Create diagrams for message flow and lifecycle
  - Purpose: Enable future maintainers to understand Windows implementation
  - _Leverage: Linux architecture patterns for comparison_
  - _Requirements: Stretch Goal (Windows-specific documentation)_
  - _Prompt: Role: Technical architect and documentation specialist | Task: Create comprehensive Windows architecture documentation covering Raw Input API and design decisions | Restrictions: Explain trade-offs vs Linux, document memory safety, include diagrams, compare with poll-based design | Success: Complete architecture doc, design decisions explained, diagrams included, testing limitations documented_

- [x] 25. Update project CHANGELOG
  - File: CHANGELOG.md
  - Add section for Windows quality improvements
  - List all bugs fixed with severity ratings
  - Note any breaking changes (if any)
  - Credit Windows quality improvement initiative
  - Compare improvements with Linux bug hunt
  - Add version number for release
  - Purpose: Record Windows quality improvements in project history
  - _Leverage: Linux bug fix CHANGELOG entries_
  - _Requirements: Standard documentation practice_
  - _Prompt: Role: Release manager specializing in changelog maintenance | Task: Update CHANGELOG with all Windows bug fixes and improvements | Restrictions: Follow existing CHANGELOG format, group by severity, note breaking changes, credit contributors | Success: CHANGELOG updated, all fixes listed, version tagged, format consistent with existing entries_
